<!DOCTYPE html>
<html>
	<head>
		<title>
			Buyer Selection
		</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	</head>

	<body onload="start()">
		<div class="container">
			<div class="page-header">
				<h1>Buyer Selection Interface</h1>
			</div>
			<div class="jumbotron">
				<h2>Available Offers</h2>
				<table class="table">
					<thead>
						<tr>
							<th>Seller</th>
							<th>Quality</th>
							<th>Price</th>
						</tr>
					</thead>
					<tbody id="tbody">
						<tr>
							<th id="seller1Name"></th>
							<td id="seller1Quality"></td>
							<td id="seller1Price"></td>
						</tr>
						<tr>
							<th id="seller2Name"></th>
							<td id="seller2Quality"></td>
							<td id="seller2Price"></td>
						</tr>
						<tr>
							<th id="seller3Name"></th>
							<td id="seller3Quality"></td>
							<td id="seller3Price"></td>
						</tr>
					</tbody>
				</table>

				<h2>Your Resale Profits</h2>
				<table class="table">
					<thead>
						<tr>
							<th>Quality</th>
							<th>Resale Price</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>Low Quality</td>
							<td id="LQSale"></td>
						</tr>
						<tr>
							<td>Medium Quality</td>
							<td id="MQSale"></td>
						</tr>
						<tr>
							<td>High Quality</td>
							<td id="HQSale"></td>
						</tr>
					</tbody>
				</table>

				<form>
					<div class="radio-inline">
						<label><input type="radio" name="sellerSelect" id="Seller1">Seller 1</label>
					</div>
					<div class="radio-inline">
						<label><input type="radio" name="sellerSelect" id="Seller2">Seller 2</label>
					</div>
					<div class="radio-inline">
						<label><input type="radio" name="sellerSelect" id="Seller3">Seller 3</label>
					</div>
					<div class="radio-inline">
						<label><input type="radio" name="sellerSelect" id="NoBuy">No Buy</label>
					</div>
				</form>
		   		<br>
		   		<button type="button" class="btn btn-success" onclick="submitBuy()">Submit</button>
			</div>

			<script src="/socket.io/socket.io.js"></script>
			<script>
				function parseQuality(quality){
					if(quality == 1)
						return "Low Quality";
					else if(quality == 2)
						return "Medium Quality";
					else
						return "High Quality";
				}
			</script>
			<script>
				var socket = io.connect();

				function start(){
					socket.emit('loadOffers');
					socket.emit('loadResale');
				}

				function submitBuy(){
					if(document.getElementById("Seller1").checked){
						socket.emit('buy', 1);
					}
					else if(document.getElementById("Seller2").checked){
						socket.emit('buy', 2);
					}
					else if(document.getElementById("Seller3").checked){
						socket.emit('buy', 3);
					}                    
					else if(document.getElementById("NoBuy").checked){
						socket.emit('buy', 0);
					}
					else{
						alert("Please select a buy option");
						return;
					}
				}

				socket.on('offersLoaded', function(data){
					document.getElementById("seller1Name").innerHTML = "Seller 1: " + data.seller1.name;
					document.getElementById("seller2Name").innerHTML = "Seller 2: " + data.seller2.name;
					document.getElementById("seller3Name").innerHTML = "Seller 3: " + data.seller3.name;
					document.getElementById("seller1Quality").innerHTML = parseQuality(data.seller1.quality);
					document.getElementById("seller2Quality").innerHTML = parseQuality(data.seller2.quality);
					document.getElementById("seller3Quality").innerHTML = parseQuality(data.seller3.quality);
					document.getElementById("seller1Price").innerHTML = "$" + data.seller1.price;
					document.getElementById("seller2Price").innerHTML = "$" + data.seller2.price;
					document.getElementById("seller3Price").innerHTML = "$" + data.seller3.price;
				});

				socket.on('resaleLoaded', function(data){
					document.getElementById("LQSale").innerHTML = "$" + data.resale1;
					document.getElementById("MQSale").innerHTML = "$" + data.resale2;
					document.getElementById("HQSale").innerHTML = "$" + data.resale3;
				});

			</script>
		</div>
		

		<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>		
	</body>
</html>
